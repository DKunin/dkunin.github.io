<!DOCTYPE html>
<html>
  <head>
    <title>Avito Unit-testing Initiative</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="./styles.css">
  </head>
  <style>
    .screenshot {
      display: inline-block;
      max-width: 100%;
      text-align: center;
      margin: 0 auto;
    }
    .screenshot img {
      max-width: 60%;
    }
  </style>
  <body>
    <textarea id="source">

class: center, middle, nopages

# Avito Front-end Unit tesing
.subtitle[тестирование вчера, сегодня, завтра]

.author[Дмитрий Кунин]

---

class: middle

- Зачем тестировать
- Что тестировать
- Чем тестировать
- Когда тестировать
- Будущее

---

class: smaller-still

### Тестироваие : user story, Ситуация A


1. Разработчик Вася (В) исправляет метод А в классе
2. Задача(З) => Тестирование Пете (П)
3. Тестировщик Петя находит ошибку => Invalid => В
5. В => воспроизведение сценария => выяснение зависимости
6. В исправляет метод B в классе
7. З => П
8. З => In review => In master
10. ~~Все счастливы~~
11. Через месяц выясняется что изменение метода B в классе - задело поведение компонента, который используется в 10 процентов случаев, заводится баг, goto 1;

---

class: smaller-still

### Тестироваие : user story, Ситуация B

1. Разработчки Вася (В) исправляет метод А в классе
2. В запускает тесты класса => method B fails
3. В исправляет метод B.
4. В pre-commit запуск общих тестов => component C fails
5. В исправляет компонент C
6. З => П
8. З => In review => In master
9. Все счастливы

---

### Что тестировать

- собственные вспомогательные библиотеки/функции/модули
- чистые функции
- redux reducers
- redux middlewares

---

### Чем тестировать

- mocha.js 
        npm test
- nyc.js (istanbul)
        npm run coverage
- pre-commit hook
        npm test
        node_modules/reviewbot/bin/reviewbot

---

class: middle, no-bullets, nopages

.screenshot[![Mocha](./images/mocha-result.png)]

---

class: center, middle, no-bullets, nopages

avito/test/front-report/lcov-report/index.html
.screenshot[![Nyc](./images/nyc-result.png)]
      
---

### Когда тестировать

- Если тест компонента существует и требует обновления
- Если написание теста не займет времени больше чем написание самого компонента
- Если есть неиспользованное время на техдолг

---

### Будущее

- Проверка покрытия всего кода
- Запуск тестов во время разработки
        npm run test:watch
- Подключение собственных репортеров (anybar, notifier, etc..)
- Тестирование компонентов взаимодействующих с DOM
- Тестирование react компонентов
- Визуально регрессионное тестирование

---

class: center, middle, nopages
# Вопросы?

Дмитрий Кунин

.no-bullets[
- vcard       : .blue[dkun.in]
- twitter     : .blue[DKunin]
- Skype       : .blue[dkunin1985]
]

    </textarea>
    <script src="remark-latest.min.js"></script>
    <!-- <script src="https://cdn.rawgit.com/knsv/mermaid/0.5.8/dist/mermaid.min.js"></script> -->
    <script>
      var slideshow = remark.create({ highlightLanguage: 'javascript' });
      // mermaid.initialize({startOnLoad:true});
    </script>
  </body>
</html>